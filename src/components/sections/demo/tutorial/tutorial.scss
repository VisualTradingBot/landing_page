// Tutorial overlay - dims the entire demo section
.tutorial-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.75);
  backdrop-filter: blur(6px);
  z-index: 10000;
  pointer-events: none;

  // Create "holes" for highlighted elements - these create transparent areas
  .tutorial-highlight {
    position: absolute;
    border: 3px solid #60a5fa;
    border-radius: 8px;
    box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75),
      0 0 20px rgba(96, 165, 250, 0.8), 0 0 40px rgba(96, 165, 250, 0.4),
      inset 0 0 20px rgba(96, 165, 250, 0.2);
    pointer-events: none;
    animation: tutorial-pulse 2s ease-in-out infinite;
    transition: all 0.3s ease;
    background: transparent;
    display: none;
  }

  .tutorial-highlight-backtest {
    border-color: #10b981;
    box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75),
      0 0 20px rgba(16, 185, 129, 0.8), 0 0 40px rgba(16, 185, 129, 0.4),
      inset 0 0 20px rgba(16, 185, 129, 0.2);
  }

  @keyframes tutorial-pulse {
    0%,
    100% {
      box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75),
        0 0 20px rgba(96, 165, 250, 0.8), 0 0 40px rgba(96, 165, 250, 0.4),
        inset 0 0 20px rgba(96, 165, 250, 0.2);
    }
    50% {
      box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75),
        0 0 30px rgba(96, 165, 250, 1), 0 0 60px rgba(96, 165, 250, 0.6),
        inset 0 0 30px rgba(96, 165, 250, 0.3);
    }
  }
}

// Explanation panel styling
.explanation-panel {
  background: #ffffff;
  border: 3px solid #000000;
  border-radius: 0;
  box-shadow: 10px 10px 0 rgba(0, 0, 0, 0.2), 0 0 50px rgba(0, 0, 0, 0.3);
  max-width: 400px;
  min-width: 320px;
  font-family: "ShareTechMono", "JetBrains Mono", "Inter", -apple-system,
    BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;

  .explanation-panel-header {
    padding: 20px 24px 16px;
    border-bottom: 2px solid #000000;

    .step-indicator {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #64748b;
      margin-bottom: 8px;
      font-family: "ITC Avant Garde Gothic Medium", ui-sans-serif, system-ui;
    }

    .explanation-title {
      font-family: "ITC Avant Garde Gothic Medium", ui-sans-serif, system-ui,
        -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      font-size: 1.5rem;
      font-weight: 700;
      color: #000000;
      margin: 0;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
  }

  .explanation-panel-body {
    padding: 20px 24px;

    .explanation-description {
      font-family: "ShareTechMono", "JetBrains Mono", "Inter", -apple-system,
        BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      font-size: 14px;
      line-height: 1.6;
      color: #000000;
      margin: 0;
    }
  }

  .explanation-panel-footer {
    padding: 16px 24px 20px;
    border-top: 2px solid #000000;
    display: flex;
    gap: 12px;
    justify-content: flex-end;

    .explanation-btn {
      padding: 10px 20px;
      font-family: "ShareTechMono", "JetBrains Mono", "Inter", -apple-system,
        BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border: 2px solid #000000;
      cursor: pointer;
      transition: all 0.2s ease;
      border-radius: 0;
      background: transparent;
      color: #000000;

      &:hover {
        background: #000000;
        color: #ffffff;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      &:active {
        transform: translateY(0);
      }

      &.explanation-btn-primary {
        background: #000000;
        color: #ffffff;

        &:hover {
          background: #1a1a1a;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
      }

      &.explanation-btn-secondary {
        background: transparent;
        color: #000000;

        &:hover {
          background: #f5f5f5;
        }
      }
    }
  }
}

// Dim ReactFlow nodes that aren't highlighted
.tutorial-active {
  .react-flow__node {
    opacity: 0.3;
    filter: brightness(0.5);
    transition: opacity 0.3s ease, filter 0.3s ease;

    // Highlight active tutorial nodes
    &[data-highlight="true"] {
      opacity: 1 !important;
      filter: brightness(1) !important;
      z-index: 1000;
    }
  }

  .react-flow__edge {
    opacity: 0.2;
    transition: opacity 0.3s ease;
  }

  // Dim backtest when highlighting graph
  .backtest {
    opacity: 0.3;
    filter: brightness(0.5);
    transition: opacity 0.3s ease, filter 0.3s ease;
  }
}

// Highlight backtest section
.tutorial-backtest-active {
  .react-flow {
    opacity: 0.3;
    filter: brightness(0.5);
    transition: opacity 0.3s ease, filter 0.3s ease;
  }

  .backtest {
    opacity: 1 !important;
    filter: brightness(1) !important;
  }
}

// Responsive adjustments
@media (max-width: 768px) {
  .explanation-panel {
    max-width: 90vw;
    min-width: 280px;

    .explanation-panel-header {
      padding: 16px 20px 12px;

      .explanation-title {
        font-size: 1.25rem;
      }
    }

    .explanation-panel-body {
      padding: 16px 20px;

      .explanation-description {
        font-size: 13px;
      }
    }

    .explanation-panel-footer {
      padding: 12px 20px 16px;
      flex-direction: column;

      .explanation-btn {
        width: 100%;
      }
    }
  }
}
